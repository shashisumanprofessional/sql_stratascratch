--ID 2004 
--Return the total number of comments received for each user in the 30-day period up to and including 2020-02-10. Don't output users who haven't received any comment in the defined time period.







CREATE TABLE fb_comments_count (
    user_id INT,
    created_at DATE,
    number_of_comments INT
);


INSERT INTO fb_comments_count (user_id, created_at, number_of_comments) VALUES
(18,'2019-12-29',1),
(25,'2019-12-21',1),
(78,'2020-01-04',1),
(37,'2020-02-01',1),
(41,'2019-12-23',1),
(99,'2020-02-02',1),
(21,'2019-12-28',1),
(18,'2020-01-31',1),
(37,'2020-02-11',1),
(58,'2020-01-26',1),
(32,'2020-01-10',1),
(24,'2020-02-03',1),
(58,'2020-01-04',1),
(8,'2020-02-10',1),
(18,'2019-12-17',1),
(18,'2019-12-30',1),
(50,'2020-01-31',1),
(82,'2019-12-22',1),
(52,'2019-12-31',1),
(78,'2020-02-10',1),
(21,'2020-01-08',1),
(4,'2019-12-22',1),
(18,'2020-01-02',1),
(89,'2019-12-25',1),
(46,'2020-01-23',1),
(32,'2020-01-17',1),
(41,'2020-01-03',1),
(8,'2020-02-05',1),
(24,'2019-12-29',2),
(56,'2019-12-25',1),
(18,'2020-02-03',1),
(56,'2019-12-21',1),
(34,'2020-01-08',1),
(27,'2020-01-10',1),
(33,'2020-01-22',1),
(78,'2020-01-07',1),
(58,'2020-02-02',1),
(82,'2019-12-30',1),
(89,'2020-01-28',1),
(46,'2019-12-23',1),
(8,'2020-01-13',1),
(9,'2020-02-02',1),
(89,'2020-01-07',1),
(87,'2020-01-08',1),
(37,'2019-12-15',1),
(95,'2020-02-10',1),
(41,'2019-12-27',1),
(82,'2020-01-16',1),
(32,'2020-01-13',1),
(99,'2020-01-05',1),
(27,'2020-01-25',1),
(52,'2020-01-01',1),
(32,'2020-01-06',1),
(56,'2019-12-19',1),
(78,'2019-12-30',1),
(33,'2020-01-28',1),
(33,'2019-12-21',1),
(32,'2020-01-04',2),
(32,'2019-12-21',1),
(89,'2020-01-16',1),
(89,'2019-12-21',1),
(52,'2019-12-20',1),
(78,'2020-02-15',1),
(32,'2019-12-23',1),
(4,'2020-02-15',1),
(99,'2020-02-03',1),
(87,'2020-02-15',1),
(34,'2020-01-15',1),
(34,'2020-01-29',1),
(32,'2019-12-18',1),
(25,'2020-02-14',1),
(89,'2020-01-05',1),
(58,'2020-01-05',1),
(46,'2020-01-29',1),
(9,'2020-01-21',1),
(9,'2020-01-06',1),
(78,'2019-12-25',1),
(46,'2019-12-29',1),
(95,'2020-01-10',1),
(95,'2020-01-17',1),
(25,'2020-01-15',1),
(87,'2019-12-25',1),
(89,'2020-02-12',1),
(25,'2020-01-20',1),
(34,'2019-12-27',1),
(27,'2019-12-21',1),
(8,'2020-01-22',1),
(37,'2020-01-19',2),
(50,'2020-01-21',1),
(18,'2019-12-27',1),
(82,'2020-01-23',1),
(21,'2019-12-24',1),
(37,'2019-12-17',1),
(33,'2019-12-31',1),
(50,'2020-01-28',1),
(32,'2019-12-19',1),
(4,'2020-01-01',1),
(22,'2020-02-15',1),
(31,'2020-01-28',1),
(22,'2020-04-04',1),
(31,'2020-01-03',1),
(22,'2019-12-19',1),
(31,'2020-02-15',1),
(22,'2019-12-01',1),
(31,'2020-04-04',1),
(16,'2019-12-27',1),
(5,'2020-01-23',1),
(7,'2019-12-24',1),
(11,'2019-12-17',1),
(61,'2019-12-31',1),
(16,'2020-01-28',1),
(5,'2019-12-19',1),
(7,'2020-01-01',1),
(11,'2020-02-15',1),
(61,'2020-01-28',1),
(11,'2020-04-04',1),
(16,'2020-01-03',1),
(5,'2019-12-19',1),
(7,'2020-02-15',1),
(11,'2019-12-01',1),
(61,'2020-04-04',1);


select * from fb_comments_count order by user_id asc;


SELECT 
    user_id, 
    SUM(number_of_comments) AS total_number_of_comments
FROM 
    fb_comments_count
WHERE 
    created_at BETWEEN DATEADD(DAY, -29, '2020-02-10') AND '2020-02-10'
GROUP BY 
    user_id;